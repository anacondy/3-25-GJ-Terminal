<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exam Details - GJ Terminal</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;700&display=swap');
        body { font-family: 'Manrope', sans-serif; background-color: #121212; color: #e0e0e0; margin: 0; padding: 2rem 3rem; }
        
        .details-header { display: flex; align-items: center; gap: 1rem; margin-bottom: 2.5rem; border-bottom: 1px solid rgba(255, 255, 255, 0.1); padding-bottom: 1.5rem; }
        .back-btn { background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.1); color: #fff; font-size: 1.5rem; border-radius: 8px; width: 40px; height: 40px; cursor: pointer; text-decoration: none; display: inline-flex; justify-content: center; align-items: center; }
        .back-btn:hover { background: rgba(255, 255, 255, 0.2); }
        .details-header h1 { margin: 0; font-size: 1.8rem; }

        /* Responsive Grid */
        .details-grid { display: grid; grid-template-columns: repeat(3, 1fr); grid-auto-rows: min-content; gap: 1.5rem; }
        @media (max-width: 1024px) { .details-grid { grid-template-columns: repeat(2, 1fr); } .cutoff-card { grid-column: span 2; } }
        @media (max-width: 768px) { body { padding: 1rem; } .details-grid { grid-template-columns: 1fr; } .specs-card, .pattern-card, .dates-card, .cutoff-card, .fee-card, .website-card, .vacancies-card { grid-column: auto; grid-row: auto; } }

        /* Cards */
        .info-card { background-color: #1e1e1e; border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 8px; padding: 1.5rem; transition: transform 0.3s ease, border-color 0.3s ease; }
        .info-card:hover { transform: translateY(-5px); border-color: rgba(255, 255, 255, 0.4); }
        
        /* Grid Placement */
        @media (min-width: 1025px) {
            .specs-card { grid-column: 1 / 2; grid-row: 1 / 3; }
            .pattern-card { grid-column: 2 / 3; grid-row: 1 / 2; }
            .dates-card { grid-column: 2 / 3; grid-row: 2 / 3; }
            .cutoff-card { grid-column: 3 / 4; grid-row: 1 / 3; }
            .fee-card { grid-column: 1 / 2; grid-row: 3 / 4; }
            .website-card { grid-column: 2 / 3; grid-row: 3 / 4; }
            .vacancies-card { grid-column: 3 / 4; grid-row: 3 / 4; }
        }

        /* Content */
        .card-title { font-size: 1.25rem; font-weight: 700; color: #fff; margin: 0 0 1rem 0; }
        .card-description { font-size: 0.95rem; color: #b0b0b0; line-height: 1.6; margin: 0; }
        .subtitle { font-size: 0.85rem; color: #888; margin-top: -0.8rem; margin-bottom: 1.5rem; }
        .no-data { color: #888; font-style: italic; margin-top: 1rem; }

        /* Tables */
        .spec-table, .pattern-table, .cutoff-table { width: 100%; border-collapse: collapse; }
        .spec-table td, .pattern-table td { padding: 0.75rem 0; border-bottom: 1px solid rgba(255, 255, 255, 0.1); vertical-align: top; }
        .spec-table tr:last-child td, .pattern-table tr:last-child td { border-bottom: none; }
        .spec-table td:first-child, .pattern-table td:first-child { color: #aaa; width: 40%; padding-right: 1em; }
        .cutoff-table { margin-top: 1rem; }
        .cutoff-table th, .cutoff-table td { padding: 12px 0; text-align: left; border-bottom: 1px solid rgba(255, 255, 255, 0.1); }
        .cutoff-table th { color: #aaa; font-weight: 600; }
        .cutoff-table tr:hover { background: rgba(255, 255, 255, 0.03); }
    </style>
</head>
<body>
    <header class="details-header">
        <a href="{{ url_for('index') }}" class="back-btn" title="Back to Terminal">&larr;</a>
        <h1>{{ job.exam_name if job else 'Error' }} Details</h1>
    </header>

    <main class="details-grid">
        <!-- 1. Specs -->
        <div class="info-card specs-card">
            <h3 class="card-title">Job Specifications</h3>
            {% if job_spec %}
            <table class="spec-table"><tbody>
                <tr><td>Nationality</td><td>{{ job_spec.nationality or 'N/A' }}</td></tr>
                <tr><td>Age Limits</td><td>{{ job_spec.age_limits or 'N/A' }}</td></tr>
                <tr><td>Age Relax.</td><td>{{ job_spec.age_relax or 'N/A' }}</td></tr>
                <tr><td>Edu. Qual.</td><td>{{ job_spec.edu_qual or 'N/A' }}</td></tr>
                <tr><td>No. of Attempts</td><td>{{ job_spec.attempts or 'N/A' }}</td></tr>
                <tr><td>Physical Standards</td><td>{{ job_spec.physical_std or 'N/A' }}</td></tr>
            </tbody></table>
            {% else %}<p class="no-data">Data not available.</p>{% endif %}
        </div>

        <!-- 2. Pattern -->
        <div class="info-card pattern-card">
            <h3 class="card-title">Exam Pattern</h3>
            {% if exam_pattern %}
            <table class="pattern-table"><tbody>
                <tr><td>Stages</td><td>{{ exam_pattern.stages or 'N/A' }}</td></tr>
                <tr><td>No. of Papers</td><td>{{ exam_pattern.num_papers or 'N/A' }}</td></tr>
                <tr><td>Type of Qs</td><td>{{ exam_pattern.q_type or 'N/A' }}</td></tr>
                <tr><td>Duration</td><td>{{ exam_pattern.duration or 'N/A' }}</td></tr>
                <tr><td>Marking Scheme</td><td>{{ exam_pattern.marking_scheme or 'N/A' }}</td></tr>
            </tbody></table>
             {% else %}<p class="no-data">Data not available.</p>{% endif %}
        </div>

        <!-- 3. Dates -->
        <div class="info-card dates-card">
            <h3 class="card-title">Important Dates</h3>
            <p class="card-description">
                <strong>Apply From:</strong> {{ job.application_start or 'TBA' }}<br>
                <strong>Apply Until:</strong> {{ job.application_end or 'TBA' }}<br>
                <strong>Exam Date:</strong> {{ job.exam_date or 'TBA' }}
            </p>
        </div>

        <!-- 4. Cutoffs -->
        <div class="info-card cutoff-card">
             <h3 class="card-title">Recent Year Cutoffs</h3>
             <p class="subtitle">Based on {{ cutoffs[0].year if cutoffs else 'latest' }} results.</p>
             {% if cutoffs and cutoffs|length > 0 %}
             <table class="cutoff-table">
                 <thead><tr><th>Category</th><th>Score</th></tr></thead>
                 <tbody>
                     {% for cutoff in cutoffs %}
                     <tr><td>{{ cutoff.category or 'N/A' }}</td><td>{{ cutoff.score or 'N/A' }}</td></tr>
                     {% endfor %}
                 </tbody>
             </table>
             {% else %}<p class="no-data">No data available.</p>{% endif %}
         </div>

        <!-- 5. Fee -->
        <div class="info-card fee-card">
            <h3 class="card-title">Application Fee</h3>
            <p class="card-description">
                {% if job.application_fee and job.application_fee|string|lower not in ['','n/a','tba','none'] %}
                    {{ job.application_fee }}
                {% else %}Details not available.{% endif %}
            </p>
        </div>

        <!-- 6. Website -->
        <div class="info-card website-card">
            <h3 class="card-title">Official Website</h3>
            {% if job.official_website and job.official_website|string|lower not in ['','n/a','tba','none'] %}
            <p class="card-description"><a href="{{ job.official_website }}" target="_blank" style="color: #FFD700; text-decoration: none;">Click to visit â†—</a></p>
            {% else %}<p class="no-data">Link not available.</p>{% endif %}
        </div>

        <!-- 7. Vacancies -->
         <div class="info-card vacancies-card">
             <h3 class="card-title">Vacancies ({{ job.vacancies_year or 'Latest' }})</h3>
             <p class="card-description">
                 {% if job.vacancies and job.vacancies|string|lower not in ['','n/a','tba','none'] %}
                    {{ job.vacancies }}
                 {% else %}Details announced in notification.{% endif %}
             </p>
         </div>
    </main>
    <script>
        document.addEventListener('keydown', function(event) {
            const verticalScrollAmount = 150;
            switch (event.key) {
                case 'ArrowUp': event.preventDefault(); window.scrollBy({ top: -verticalScrollAmount, behavior: 'smooth' }); break;
                case 'ArrowDown': event.preventDefault(); window.scrollBy({ top: verticalScrollAmount, behavior: 'smooth' }); break;
            }
        });
    </script>
</body>
</html>
